# エクセル拡張ツール その他

# マクロのブロック解除
2022年4月から、インターネット経由で入手された MS-OfficeファイルのVBAマクロが**デフォルトでブロック**される仕様となりました。ダウンロード後の初回利用前には、ファイルのブロックを解除してください。
解除方法は [エクセル拡張ツール インストール方法](installation.md) のページを参照ください。

<br>

# 機能制限事項
## 「元に戻す (Ctrl+Z)」の制限
本ツールが提供する機能はVBAマクロで実装されています。VBAマクロの仕様上、本ツールの各機能を実行後、それ以前の操作について「元に戻す (Ctrl+Z)」が効かなくなります（エクセルの操作バッファがクリアされます）。使用に際しては留意願います。

<br>

## ブックが共有されている場合のハイパーリンクに関する制限
本ツールが提供する各機能の内、ハイパーリンクの設定に関する機能はブックが共有されている場合には無効となります。
これはエクセルの仕様として、ブック共有時のハイパーリンク操作が禁じられていることに起因します。

<br>

# 本ツールの使用について
## ソフトウェア形態
本ツールはフリーウェアです。将来にわたり有料化の予定はありません。<br>
一般的なフリーウェアの使用慣例に従って自己責任の下、ご利用ください。フリーウェアという性質上、サポートをお約束することはできません。
## ソースコード
ソースはすべて開示されています。変更、流用等に制限は設けていません。ご自由にお使いください。エクセルのVBAエディタ（Alt+F11）でそのまま開けます。将来にわたり非公開化の予定はありません。
## 配布
最新版は GitHub (https://github.com/koichiro-git/extools) にて配布されます。適宜取得してください。

<br>

# 定数の編集
本ツールの動作のうち、いくつかの項目についてはソースコード内の定数を編集することで簡易にカスタマイズ可能です。定数は 
ExTools.xlam 内の mdlCommon.bas 先頭部分に定義されています。以下に主な定数とその内容を一覧します。

| No. | 定数名 | 項目名 | デフォルト値 | 説明 |
| :-: | - | - | - | - |
| 1 | mdlCommon.APP_FONT | 表示フォント | Meiryo UI | 本ツールが結果を出力する際の文字フォント |
| 2 | frmCommon.APP_FONT_SIZE | 表示フォントサイズ | 9ポイント | 本ツールが結果を出力する際の文字サイズ |
| 3 | frmCommon.HED_LEFT | ヘッダ文字列（左） | 空（""） | 「シートの設定」でヘッダに表示する文字列 |
| 4 | frmCommon.HED_CENTER | ヘッダ文字列（中央） | 空（""） | 「シートの設定」でヘッダに表示する文字列 |
| 5 | frmCommon.HED_RIGHT | ヘッダ文字列（右） | 空（""） | 「シートの設定」でヘッダに表示する文字列 |
| 6 | frmCommon.FOT_LEFT | フッタ文字列（左） | シート名 / ファイル名 | 「シートの設定」でフッタに表示する文字列 |
| 7 | frmCommon.FOT_CENTER | フッタ文字列（中央） | ページ番号/総ページ数 | 「シートの設定」でフッタに表示する文字列 |
| 8 | frmCommon.FOT_RIGHT | フッタ文字列（右） | 印刷日時 | 「シートの設定」でフッタに表示する文字列 |
| 9 | frmCommon.MRG_LEFT | 印刷マージン（左） | 0.6インチ | 「シートの設定」で設定する印刷マージン |
| 10 | frmCommon.MRG_RIGHT | 印刷マージン（右） | 0.6インチ | 「シートの設定」で設定する印刷マージン |
| 11 | frmCommon.MRG_TOP | 印刷マージン（上） | 0.8インチ | 「シートの設定」で設定する印刷マージン |
| 12 | frmCommon.MRG_BOTTOM | 印刷マージン（下） | 0.4インチ | 「シートの設定」で設定する印刷マージン |
| 13 | frmCommon.MRG_HEADER | 印刷マージン（ヘッダ） | 0.6インチ | 「シートの設定」で設定する印刷マージン |
| 14 | frmCommon.MRG_FOOTER | 印刷マージン（フッタ） | 0.2インチ | 「シートの設定」で設定する印刷マージン |

